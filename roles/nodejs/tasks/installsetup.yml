---

- name: node | create group
  group:
    name: node
    state: present

- name: node | create user
  user:
    name: node
    comment: node user
    group: node
    state: present

- name: node |download 
  get_url:
    url: https://nodejs.org/dist/{{ version_node }}/node-{{ version_node }}-linux-x64.tar.xz
    dest: /tmp/node-{{ version_node }}-linux-x64.tar.xz
    #args:
    #creates: /tmp/node.download

- name: node | extract
  unarchive:
    src: /tmp/node-{{ version_node }}-linux-x64.tar.xz
    dest: /usr/local/
    remote_src: yes
    owner: node 
    group: node
  args: 
    creates: /usr/local/node-{{ version_node }}-linux-x64/bin/node

- name: node | rename
  shell:
       > 
       mv /usr/local/node-v10.15.3-linux-x64  /usr/local/node; ln -s /usr/local/node/bin/node  /usr/bin/node
  args:
    creates: /usr/local/node/bin/node

- name: node | create profile
  template: src=node.profile  dest=/etc/profile.d/node.sh  mode=755 


- name: node | install express
  shell:
       > 
       /usr/local/node/bin/npm install --save express ; chown node:node -R /usr/local/node/lib/node_modules
  args:
    chdir: /usr/local/node/lib/node_modules
    creates: /usr/local/node/lib/node_modules/express/index.js     



